<!DOCTYPE html>
 <html lang="en">
 <head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Magic Numbers - Accessible Color Palette Generator</title>
   <style>
     /* Reset and base styles */
     * {
       margin: 0;
       padding: 0;
       box-sizing: border-box;
     }
 
     body {
       font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
       line-height: 1.5;
       color: #333;
       background-color: #fff;
     }
 
     .container {
       max-width: 1200px;
       margin: 0 auto;
       padding: 1.5rem;
     }
 
     /* Header styles */
     header {
       display: flex;
       justify-content: space-between;
       align-items: center;
       margin-bottom: 2rem;
     }
 
     h1 {
       font-size: 1.875rem;
       font-weight: bold;
     }
 
     .credit {
       color: #6b7280;
     }
 
     .credit a {
       color: #2563eb;
       text-decoration: underline;
     }
 
     .credit a:hover {
       text-decoration: underline;
     }
 
     /* Input section styles */
     .input-section {
       border: 1px solid #e5e7eb;
       padding: 1.5rem;
       margin-bottom: 2rem;
     }
 
     .input-section h2 {
       font-size: 1.25rem;
       font-weight: 500;
       margin-bottom: 1rem;
     }
 
     .input-row {
       display: flex;
       gap: 1rem;
       align-items: center;
       flex-wrap: wrap;
     }
 
     .hex-input {
       font-family: monospace;
       font-size: 1.125rem;
       padding: 0.75rem 1rem;
       border: 1px solid #e5e7eb;
       width: 400px;
       max-width: 100%;
       height: 3rem;
     }
 
     .guide-button {
       display: flex;
       align-items: center;
       gap: 0.5rem;
       background-color: #fff;
       border: 1px solid #e5e7eb;
       padding: 0.75rem 1rem;
       font-size: 1rem;
       height: 3rem;
       cursor: pointer;
     }
 
     .guide-button:hover {
       background-color: #f9fafb;
     }
 
     .chevron {
       transition: transform 0.3s ease;
     }
 
     .chevron.open {
       transform: rotate(180deg);
     }
 
     .message {
       display: flex;
       align-items: center;
       gap: 0.5rem;
       margin-top: 0.75rem;
       color: #000;
       font-size: 14px;
     }
 
     .error-message {
       color: #b91c1c;
     }
 
     /* Accordion styles */
     .accordion-content {
       display: none;
       padding: 1rem;
       border: 1px solid #e5e7eb;
       margin-top: 0.5rem;
       max-width: 600px;
     }
 
     .accordion-content.show {
       display: block;
     }
 
     .accordion-content h3 {
       font-weight: 500;
       margin-bottom: 0.5rem;
       font-size: 0.875rem;
     }
 
     .accordion-content p {
       font-size: 0.875rem;
       color: #333;
       margin-bottom: 0.75rem;
     }
 
     .accordion-content ul {
       font-size: 0.875rem;
       color: #333;
       padding-left: 1.5rem;
       margin-bottom: 0.75rem;
     }
 
     .accordion-content li {
       margin-bottom: 0.5rem;
     }
 
     /* Tabs styles */
     .tabs {
       margin-bottom: 1rem;
     }
 
     .tab-list {
       display: flex;
       gap: 0.5rem;
       border-bottom: 1px solid #e5e7eb;
       margin-bottom: 1.5rem;
     }
 
     .tab {
       padding: 0.5rem 1rem;
       border: none;
       background: none;
       cursor: pointer;
       font-size: 0.875rem;
       font-weight: 500;
       color: #6b7280;
       border-bottom: 2px solid transparent;
     }
 
     .tab.active {
       color: #000;
       border-bottom: 2px solid #000;
     }
 
     /* Color palette grid */
     .color-grid {
       display: grid;
       grid-template-columns: repeat(1, 1fr);
       gap: 1rem;
       margin-bottom: 1.5rem;
     }
 
     @media (min-width: 640px) {
       .color-grid {
         grid-template-columns: repeat(2, 1fr);
       }
     }
 
     @media (min-width: 768px) {
       .color-grid {
         grid-template-columns: repeat(3, 1fr);
       }
     }
 
     @media (min-width: 1024px) {
       .color-grid {
         grid-template-columns: repeat(6, 1fr);
       }
     }
 
     .color-card {
       border: 1px solid #e5e7eb;
       position: relative;
       cursor: pointer;
     }
 
     .color-card.active {
       border: 3px solid #000;
     }
 
     .color-swatch {
       height: 128px;
       width: 100%;
       position: relative;
     }
 
     .color-info {
       padding: 0.75rem;
     }
 
     .grade-row {
       font-size: 16px;
       font-weight: 600;
       display: flex;
       align-items: center;
       gap: 0.5rem;
     }
 
     .active-indicator {
       width: 6px;
       height: 6px;
       background-color: #000;
       display: inline-block;
     }
 
     .color-hex {
       font-family: monospace;
       font-size: 14px;
       color: #6b7280;
       margin-top: 0.25rem;
     }
 
     .color-luminance {
       color: #6b7280;
       font-size: 14px;
       margin-top: 0.25rem;
     }
 
     /* Copy button */
     .copy-button {
       position: absolute;
       top: 50%;
       left: 50%;
       transform: translate(-50%, -50%);
       background-color: white;
       color: black;
       border: none;
       padding: 0.5rem 1rem;
       font-size: 0.75rem;
       cursor: pointer;
       display: none;
       box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
       z-index: 10;
     }
 
     .color-card:hover .copy-button {
       display: block;
     }
 
     /* Table styles */
     .table-container {
       border: 1px solid #e5e7eb;
       overflow-x: auto;
     }
 
     table {
       width: 100%;
       border-collapse: collapse;
     }
 
     th {
       text-align: left;
       padding: 0.75rem 1rem;
       font-weight: 500;
       color: #6b7280;
       border-bottom: 1px solid #e5e7eb;
     }
 
     td {
       padding: 0.75rem 1rem;
       border-bottom: 1px solid #e5e7eb;
     }
 
     tr:last-child td {
       border-bottom: none;
     }
 
     .color-sample {
       width: 2rem;
       height: 2rem;
       border: 1px solid #e5e7eb;
     }
 
     .hex-cell {
       font-family: monospace;
     }
 
     .active-row {
       background-color: #f9fafb;
     }
 
     .active-row .grade-cell {
       display: flex;
       align-items: center;
       gap: 0.5rem;
     }
 
     .table-copy-button {
       background-color: white;
       color: black;
       border: 1px solid #e5e7eb;
       padding: 0.25rem 0.5rem;
       font-size: 0.75rem;
       cursor: pointer;
     }
 
     .table-copy-button:hover {
       background-color: #f9fafb;
     }
 
     /* Utility classes */
     .hidden {
       display: none;
     }
   </style>
 </head>
 <body>
   <div class="container">
     <header>
       <h1>Magic Numbers</h1>
       <p class="credit">
         Created by <a href="https://www.linkedin.com/in/sviatoslav-nytka/" target="_blank">Sviatoslav Nytka</a> from <a href="https://magicflux.co" target="_blank" >MagicFlux</a>
       </p>
     </header>
 
     <div class="input-section">
       <h2>Enter HEX Color Code</h2>
       <div class="input-row">
         <input 
           type="text" 
           id="hexInput" 
           class="hex-input" 
           value="#FFFFFF" 
           placeholder="#000000"
         >
         <button class="guide-button" id="guideButton">
           <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
             <circle cx="12" cy="12" r="10"></circle>
             <path d="M12 16v-4"></path>
             <path d="M12 8h.01"></path>
           </svg>
           <span>Magic Numbers Guide</span>
           <svg id="chevron" class="chevron" xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
             <path d="m6 9 6 6 6-6"></path>
           </svg>
         </button>
       </div>
 
       <div id="warningMessage" class="message hidden">
         <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
           <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
           <line x1="12" y1="9" x2="12" y2="13"></line>
           <line x1="12" y1="17" x2="12.01" y2="17"></line>
         </svg>
         <span id="warningText"></span>
       </div>
 
       <div id="errorMessage" class="message error-message hidden">
         <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
           <circle cx="12" cy="12" r="10"></circle>
           <line x1="15" y1="9" x2="9" y2="15"></line>
           <line x1="9" y1="9" x2="15" y2="15"></line>
         </svg>
         <span>Please enter a valid hex color code</span>
       </div>
 
       <div class="accordion-content" id="guideContent">
         <p>
           This tool is inspired by <a href="https://designsystem.digital.gov/design-tokens/color/overview/" target="_blank">USWDS</a>, to help you create color combinations that meet accessibility standards.
         </p>
         <p>
           System assigns each color a grade from 0 (white) to 100 (black).
         </p>
         <p>
           The "magic number" is simply the difference between the grades of two colors.
         </p>
         <p>Accessibility levels:</p>
         <ul>
           <li>40+: Meets WCAG 2.2 AA for large text (3+)</li>
           <li>50+: Meets WCAG 2.2 AA for standard text and AAA for large text (4.5+)</li>
           <li>70+: Meets WCAG 2.2 AAA for standard text (7+)</li>
         </ul>
       </div>
     </div>
 
     <div class="tabs">
       <div class="tab-list">
         <button class="tab active" data-tab="palette">Color Palette</button>
         <button class="tab" data-tab="table">Luminance Table</button>
       </div>
 
       <div id="paletteTab" class="tab-content">
         <div id="colorGridRow1" class="color-grid"></div>
         <div id="colorGridRow2" class="color-grid"></div>
       </div>
 
       <div id="tableTab" class="tab-content hidden">
         <div class="table-container">
           <table>
             <thead>
               <tr>
                 <th>Grade</th>
                 <th>Color</th>
                 <th>Hex Code</th>
                 <th>Luminance</th>
                 <th>Target Range</th>
                 <th>Copy</th>
               </tr>
             </thead>
             <tbody id="tableBody"></tbody>
           </table>
         </div>
       </div>
     </div>
   </div>
 
   <script>
     // Define the luminance ranges for each grade
     const LUMINANCE_RANGES = [
       { grade: 0, min: 1.000, max: 1.000 },
       { grade: 5, min: 0.850, max: 0.930 },
       { grade: 10, min: 0.750, max: 0.820 },
       { grade: 20, min: 0.500, max: 0.650 },
       { grade: 30, min: 0.350, max: 0.450 },
       { grade: 40, min: 0.225, max: 0.300 },
       { grade: 50, min: 0.175, max: 0.183 },
       { grade: 60, min: 0.100, max: 0.125 },
       { grade: 70, min: 0.050, max: 0.070 },
       { grade: 80, min: 0.020, max: 0.040 },
       { grade: 90, min: 0.005, max: 0.015 },
       { grade: 100, min: 0.000, max: 0.000 },
     ];
 
     // Color conversion utilities
     function hexToRgb(hex) {
       const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
       return result
         ? {
             r: parseInt(result[1], 16),
             g: parseInt(result[2], 16),
             b: parseInt(result[3], 16),
           }
         : null;
     }
 
     function rgbToHex(r, g, b) {
       return "#" + ((1 << 24) | (r << 16) | (g << 8) | b).toString(16).slice(1).toUpperCase();
     }
 
     function rgbToHsl(r, g, b) {
       r /= 255;
       g /= 255;
       b /= 255;
 
       const max = Math.max(r, g, b);
       const min = Math.min(r, g, b);
       let h = 0;
       let s = 0;
       let l = (max + min) / 2;
 
       if (max !== min) {
         const d = max - min;
         s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
 
         switch (max) {
           case r:
             h = (g - b) / d + (g < b ? 6 : 0);
             break;
           case g:
             h = (b - r) / d + 2;
             break;
           case b:
             h = (r - g) / d + 4;
             break;
         }
 
         h /= 6;
       }
 
       return { h, s, l };
     }
 
     function hslToRgb(h, s, l) {
       let r, g, b;
 
       if (s === 0) {
         r = g = b = l;
       } else {
         const hue2rgb = (p, q, t) => {
           if (t < 0) t += 1;
           if (t > 1) t -= 1;
           if (t < 1 / 6) return p + (q - p) * 6 * t;
           if (t < 1 / 2) return q;
           if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
           return p;
         };
 
         const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
         const p = 2 * l - q;
 
         r = hue2rgb(p, q, h + 1 / 3);
         g = hue2rgb(p, q, h);
         b = hue2rgb(p, q, h - 1 / 3);
       }
 
       return {
         r: Math.round(r * 255),
         g: Math.round(g * 255),
         b: Math.round(b * 255),
       };
     }
 
     // Calculate relative luminance according to WCAG
     function calculateLuminance(r, g, b) {
       const rsrgb = r / 255;
       const gsrgb = g / 255;
       const bsrgb = b / 255;
 
       const r1 = rsrgb <= 0.03928 ? rsrgb / 12.92 : Math.pow((rsrgb + 0.055) / 1.055, 2.4);
       const g1 = gsrgb <= 0.03928 ? gsrgb / 12.92 : Math.pow((gsrgb + 0.055) / 1.055, 2.4);
       const b1 = bsrgb <= 0.03928 ? bsrgb / 12.92 : Math.pow((bsrgb + 0.055) / 1.055, 2.4);
 
       return 0.2126 * r1 + 0.7152 * g1 + 0.0722 * b1;
     }
 
     // Find the closest grades to a luminance value
     function findNeighboringGrades(luminance) {
       let lowerGrade = null;
       let higherGrade = null;
 
       // Sort ranges by min luminance (descending)
       const sortedRanges = [...LUMINANCE_RANGES].sort((a, b) => b.min - a.min);
 
       for (let i = 0; i < sortedRanges.length; i++) {
         if (luminance > sortedRanges[i].min) {
           higherGrade = i > 0 ? sortedRanges[i-1].grade : null;
           lowerGrade = sortedRanges[i].grade;
           break;
         }
       }
 
       // If we didn't find a lower grade, it means the luminance is lower than the lowest grade
       if (lowerGrade === null) {
         lowerGrade = sortedRanges[sortedRanges.length - 1].grade;
       }
 
       return { lowerGrade, higherGrade };
     }
 
     // Determine the grade based on luminance
     function determineGrade(luminance) {
       for (const range of LUMINANCE_RANGES) {
         if (luminance >= range.min && luminance <= range.max) {
           return { grade: range.grade, exact: true };
         }
       }
 
       // If no exact match, find the closest grade
       let closestGrade = 50; // Default to middle grade
       let minDifference = Number.MAX_VALUE;
 
       for (const range of LUMINANCE_RANGES) {
         const midRange = (range.min + range.max) / 2;
         const difference = Math.abs(luminance - midRange);
 
         if (difference < minDifference) {
           minDifference = difference;
           closestGrade = range.grade;
         }
       }
 
       const { lowerGrade, higherGrade } = findNeighboringGrades(luminance);
 
       return { 
         grade: closestGrade, 
         exact: false,
         lowerGrade: lowerGrade,
         higherGrade: higherGrade 
       };
     }
 
     // Generate a color with specific luminance while preserving hue and saturation
     function generateColorWithLuminance(hue, saturation, targetLuminance) {
       let low = 0;
       let high = 1;
       let mid = 0.5;
       let iterations = 0;
       const maxIterations = 20;
 
       while (iterations < maxIterations) {
         const rgb = hslToRgb(hue, saturation, mid);
         const luminance = calculateLuminance(rgb.r, rgb.g, rgb.b);
 
         if (Math.abs(luminance - targetLuminance) < 0.001) {
           return rgbToHex(rgb.r, rgb.g, rgb.b);
         }
 
         if (luminance > targetLuminance) {
           high = mid;
         } else {
           low = mid;
         }
 
         mid = (low + high) / 2;
         iterations++;
       }
 
       const finalRgb = hslToRgb(hue, saturation, mid);
       return rgbToHex(finalRgb.r, finalRgb.g, finalRgb.b);
     }
 
     // Generate the full palette based on the input color
     function generatePalette(hexColor) {
       const rgb = hexToRgb(hexColor);
       if (!rgb) return [];
 
       const { h, s } = rgbToHsl(rgb.r, rgb.g, rgb.b);
       const palette = [];
 
       for (const range of LUMINANCE_RANGES) {
         const targetLuminance = (range.min + range.max) / 2;
         const color = generateColorWithLuminance(h, s, targetLuminance);
         const actualRgb = hexToRgb(color);
         const actualLuminance = actualRgb ? calculateLuminance(actualRgb.r, actualRgb.g, actualRgb.b) : 0;
 
         palette.push({
           grade: range.grade,
           color,
           luminance: actualLuminance,
         });
       }
 
       return palette;
     }
 
     // DOM elements
     const hexInput = document.getElementById('hexInput');
     const colorGridRow1 = document.getElementById('colorGridRow1');
     const colorGridRow2 = document.getElementById('colorGridRow2');
     const tableBody = document.getElementById('tableBody');
     const guideButton = document.getElementById('guideButton');
     const guideContent = document.getElementById('guideContent');
     const warningMessage = document.getElementById('warningMessage');
     const warningText = document.getElementById('warningText');
     const errorMessage = document.getElementById('errorMessage');
     const tabs = document.querySelectorAll('.tab');
     const tabContents = document.querySelectorAll('.tab-content');
     const chevron = document.getElementById('chevron');
 
     // Format and validate hex input
     function formatHexInput(input) {
       // Remove all # symbols
       let formattedInput = input.replace(/#/g, '');
 
       // Add a single # at the beginning
       formattedInput = '#' + formattedInput;
 
       // Convert to uppercase
       return formattedInput.toUpperCase();
     }
 
     // Copy color to clipboard
     function copyToClipboard(text, button) {
       navigator.clipboard.writeText(text).then(() => {
         // Change button text if provided
         if (button) {
           const originalText = button.textContent;
           button.textContent = 'Copied!';
 
           setTimeout(() => {
             button.textContent = originalText;
           }, 2000);
         }
 
         // Show a temporary toast message
         const toast = document.createElement('div');
         toast.textContent = 'Copied: ' + text;
         toast.style.position = 'fixed';
         toast.style.bottom = '20px';
         toast.style.left = '50%';
         toast.style.transform = 'translateX(-50%)';
         toast.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
         toast.style.color = 'white';
         toast.style.padding = '8px 16px';
         toast.style.borderRadius = '4px';
         toast.style.zIndex = '1000';
 
         document.body.appendChild(toast);
 
         setTimeout(() => {
           document.body.removeChild(toast);
         }, 2000);
       });
     }
 
     // Validate hex color
     function isValidHex(hex) {
       return /^#([A-Fa-f0-9]{6})$/.test(hex);
     }
 
     // Update the palette based on the input color
     function updatePalette() {
       const hexColor = hexInput.value;
 
       // Check if the hex color is valid
       if (hexColor.length > 7) {
         errorMessage.classList.remove('hidden');
         warningMessage.classList.add('hidden');
         return;
       } else {
         errorMessage.classList.add('hidden');
       }
 
       if (isValidHex(hexColor)) {
         const rgb = hexToRgb(hexColor);
         const luminance = calculateLuminance(rgb.r, rgb.g, rgb.b);
         const gradeInfo = determineGrade(luminance);
         const palette = generatePalette(hexColor);
 
         // Show warning if not an exact grade match
         warningMessage.classList.toggle('hidden', gradeInfo.exact);
         if (!gradeInfo.exact && gradeInfo.lowerGrade !== null && gradeInfo.higherGrade !== null) {
           warningText.textContent = `This color falls between grades ${gradeInfo.lowerGrade} and ${gradeInfo.higherGrade}`;
         } else if (!gradeInfo.exact) {
           warningText.textContent = `This color doesn't match any exact grade`;
         }
 
         // Clear existing content
         colorGridRow1.innerHTML = '';
         colorGridRow2.innerHTML = '';
         tableBody.innerHTML = '';
 
         // Populate the first row (grades 0-40)
         palette.slice(0, 6).forEach(item => {
           const card = document.createElement('div');
           card.className = 'color-card';
           card.onclick = () => copyToClipboard(item.color);
 
           // Add active class if this is the input color's grade
           if (item.grade === gradeInfo.grade) {
             card.classList.add('active');
           }
 
           const swatch = document.createElement('div');
           swatch.className = 'color-swatch';
           swatch.style.backgroundColor = item.color;
 
           const copyBtn = document.createElement('button');
           copyBtn.className = 'copy-button';
           copyBtn.textContent = 'Copy';
           copyBtn.onclick = (e) => {
             e.stopPropagation();
             copyToClipboard(item.color, copyBtn);
           };
 
           swatch.appendChild(copyBtn);
 
           const info = document.createElement('div');
           info.className = 'color-info';
 
           const gradeRow = document.createElement('div');
           gradeRow.className = 'grade-row';
 
           if (item.grade === gradeInfo.grade) {
             const indicator = document.createElement('span');
             indicator.className = 'active-indicator';
             gradeRow.appendChild(indicator);
           }
 
           gradeRow.appendChild(document.createTextNode(`Grade ${item.grade}`));
 
           const hexText = document.createElement('div');
           hexText.className = 'color-hex';
           hexText.textContent = item.color;
 
           const luminanceText = document.createElement('div');
           luminanceText.className = 'color-luminance';
           luminanceText.textContent = `Luminance: ${item.luminance.toFixed(3)}`;
 
           info.appendChild(gradeRow);
           info.appendChild(hexText);
           info.appendChild(luminanceText);
 
           card.appendChild(swatch);
           card.appendChild(info);
 
           colorGridRow1.appendChild(card);
         });
 
         // Populate the second row (grades 50-100)
         palette.slice(6).forEach(item => {
           const card = document.createElement('div');
           card.className = 'color-card';
           card.onclick = () => copyToClipboard(item.color);
 
           // Add active class if this is the input color's grade
           if (item.grade === gradeInfo.grade) {
             card.classList.add('active');
           }
 
           const swatch = document.createElement('div');
           swatch.className = 'color-swatch';
           swatch.style.backgroundColor = item.color;
 
           const copyBtn = document.createElement('button');
           copyBtn.className = 'copy-button';
           copyBtn.textContent = 'Copy';
           copyBtn.onclick = (e) => {
             e.stopPropagation();
             copyToClipboard(item.color, copyBtn);
           };
 
           swatch.appendChild(copyBtn);
 
           const info = document.createElement('div');
           info.className = 'color-info';
 
           const gradeText = document.createElement('div');
           gradeText.className = 'grade-row';
 
           if (item.grade === gradeInfo.grade) {
             const indicator = document.createElement('span');
             indicator.className = 'active-indicator';
             gradeText.appendChild(indicator);
           }
 
           gradeText.appendChild(document.createTextNode(`Grade ${item.grade}`));
 
           const hexText = document.createElement('div');
           hexText.className = 'color-hex';
           hexText.textContent = item.color;
 
           const luminanceText = document.createElement('div');
           luminanceText.className = 'color-luminance';
           luminanceText.textContent = `Luminance: ${item.luminance.toFixed(3)}`;
 
           info.appendChild(gradeText);
           info.appendChild(hexText);
           info.appendChild(luminanceText);
 
           card.appendChild(swatch);
           card.appendChild(info);
 
           colorGridRow2.appendChild(card);
         });
 
         // Populate the table
         palette.forEach(item => {
           const row = document.createElement('tr');
 
           // Highlight row if it matches the input color grade
           if (item.grade === gradeInfo.grade) {
             row.classList.add('active-row');
           }
 
           const gradeCell = document.createElement('td');
           gradeCell.className = 'grade-cell';
 
           if (item.grade === gradeInfo.grade) {
             const indicator = document.createElement('span');
             indicator.className = 'active-indicator';
             gradeCell.appendChild(indicator);
           }
 
           gradeCell.appendChild(document.createTextNode(item.grade));
 
           const colorCell = document.createElement('td');
           const colorSample = document.createElement('div');
           colorSample.className = 'color-sample';
           colorSample.style.backgroundColor = item.color;
           colorCell.appendChild(colorSample);
 
           const hexCell = document.createElement('td');
           hexCell.className = 'hex-cell';
           hexCell.textContent = item.color;
 
           const luminanceCell = document.createElement('td');
           luminanceCell.textContent = item.luminance.toFixed(3);
 
           const rangeCell = document.createElement('td');
           const range = LUMINANCE_RANGES.find(range => range.grade === item.grade);
           rangeCell.textContent = `${range.min.toFixed(3)} - ${range.max.toFixed(3)}`;
 
           const copyCell = document.createElement('td');
           const copyButton = document.createElement('button');
           copyButton.className = 'table-copy-button';
           copyButton.textContent = 'Copy';
           copyButton.onclick = () => copyToClipboard(item.color, copyButton);
           copyCell.appendChild(copyButton);
 
           row.appendChild(gradeCell);
           row.appendChild(colorCell);
           row.appendChild(hexCell);
           row.appendChild(luminanceCell);
           row.appendChild(rangeCell);
           row.appendChild(copyCell);
 
           tableBody.appendChild(row);
         });
       }
     }
 
     // Event listeners
     hexInput.addEventListener('input', function() {
       this.value = formatHexInput(this.value);
       updatePalette();
     });
 
     // Toggle the guide content
     guideButton.addEventListener('click', function() {
       guideContent.classList.toggle('show');
       chevron.classList.toggle('open');
     });
 
     // Tab switching
     tabs.forEach(tab => {
       tab.addEventListener('click', function() {
         // Remove active class from all tabs
         tabs.forEach(t => t.classList.remove('active'));
 
         // Add active class to clicked tab
         this.classList.add('active');
 
         // Hide all tab contents
         tabContents.forEach(content => content.classList.add('hidden'));
 
         // Show the selected tab content
         const tabId = this.getAttribute('data-tab');
         document.getElementById(`${tabId}Tab`).classList.remove('hidden');
       });
     });
 
     // Close the guide content when clicking outside
     document.addEventListener('click', function(event) {
       if (!event.target.closest('#guideButton') && !event.target.closest('#guideContent')) {
         if (guideContent.classList.contains('show')) {
           guideContent.classList.remove('show');
           chevron.classList.remove('open');
         }
       }
     });
 
     // Initialize the palette
     updatePalette();
   </script>
 </body>
 </html>
